# 📝 Nanote 要件定義書 v1.0

> **Nanote** = "nano"（極小・軽量）+ "note"
> _限りなく軽く、一瞬で書き始められるメモアプリ_

---

## 1. プロジェクト概要

| 項目       | 内容                                           |
| ---------- | ---------------------------------------------- |
| アプリ名   | **Nanote**（ナノート）                         |
| コンセプト | 瞬時起動・軽量動作で「書く気になる」メモアプリ |
| ターゲット | 一般ユーザー（非エンジニア含む）               |
| 技術基盤   | Rust + gpui                                    |
| データ保存 | SQLite（完全ローカル）                         |
| 対応OS     | Windows（優先）、macOS、Linux                  |

---

## 2. 解決する課題

```
既存メモアプリの不満
├── 起動が遅く、メモを書く気にならない
├── 各種操作（検索・切替・保存）がもっさりする
└── Electron系アプリのメモリ消費が大きい

Nanoteの解決策
├── gpuiによるネイティブGPU描画 → 瞬時起動
├── Rust + SQLite → 軽量・高速な全操作
└── 最小限のリソース消費
```

---

## 3. 画面構成

### 3.1 全体レイアウト（VSCode風）

```
┌─────────────────────────────────────────────────┐
│  [Tab: メモA]  [Tab: メモB]  [Tab: +]           │
├────────────┬────────────────────────────────────┤
│  🔍 検索    │                                    │
│  ─────────  │  # メモのタイトル                    │
│  📁 フォルダ │                                    │
│   📁 仕事   │  ここにメモの本文が入ります。          │
│    📄 議事録 │                                    │
│    📄 TODO  │  **太字**も即座にレンダリング          │
│   📁 個人   │                                    │
│    📄 買物  │  - リスト項目1                       │
│  ─────────  │  - リスト項目2                       │
│  🏷️ タグ    │                                    │
│   🔴 仕事   │                                    │
│   🔵 重要   │                                    │
│   🟢 アイデア│                                    │
├────────────┤                                    │
│  ステータス  │                                    │
└────────────┴────────────────────────────────────┘
```

### 3.2 各エリアの役割

| エリア             | 説明                                                     |
| ------------------ | -------------------------------------------------------- |
| **タブバー**       | 開いているメモをタブで横並び表示。無制限。`+` で新規メモ |
| **サイドバー**     | フォルダツリー・タグ一覧・検索。表示/非表示切替可能      |
| **エディタ**       | Markdownライブレンダリング。メインの編集領域             |
| **ステータスバー** | 文字数・更新日時・現在のフォルダ等                       |

---

## 4. 機能要件

### 4.1 MVP（最小リリース）

#### 4.1.1 メモ管理（CRUD）

| 機能     | 詳細                                                   |
| -------- | ------------------------------------------------------ |
| 作成     | 新規メモ作成。デフォルトタイトルは「無題のメモ」＋連番 |
| 閲覧     | タブで複数メモを同時に開ける                           |
| 編集     | Markdownライブレンダリングで編集                       |
| 削除     | 削除確認ダイアログ付き                                 |
| 自動保存 | 編集中に自動保存（入力停止から数秒後）                 |

#### 4.1.2 Markdownエディタ

| 機能               | 詳細                                                                                      |
| ------------------ | ----------------------------------------------------------------------------------------- |
| ライブレンダリング | Markdown記法を入力すると即座に装飾が反映される（Apple Notes風）                           |
| 対応記法（MVP）    | 見出し(`#`)、太字、斜体、リスト（箇条書き・番号）、チェックボックス、引用、水平線、リンク |
| ショートカット     | `Ctrl+B` 太字、`Ctrl+I` 斜体、`Ctrl+K` リンク 等                                          |

#### 4.1.3 フォルダ管理

| 機能     | 詳細                                    |
| -------- | --------------------------------------- |
| 作成     | 任意の名前でフォルダ作成                |
| ネスト   | 無制限の階層構造                        |
| 移動     | ドラッグ&ドロップでメモ・フォルダを移動 |
| リネーム | ダブルクリックまたは右クリックから      |
| 削除     | 中身ごと削除（確認ダイアログ付き）      |

#### 4.1.4 タグ管理

| 機能       | 詳細                                                  |
| ---------- | ----------------------------------------------------- |
| 作成       | 任意の名前＋色を指定して作成                          |
| 色指定     | プリセットカラーから選択（赤・青・緑・黄・紫・橙 等） |
| 付与       | 1メモに複数タグを付与可能                             |
| フィルタ   | サイドバーでタグをクリック → 該当メモ一覧表示         |
| 編集・削除 | タグ名・色の変更、タグの削除                          |

#### 4.1.5 検索

| 機能         | 詳細                                           |
| ------------ | ---------------------------------------------- |
| 全文検索     | メモのタイトル＋本文をSQLite FTS5で検索        |
| タグ検索     | `tag:仕事` で「仕事」タグのメモを検索          |
| フォルダ検索 | `folder:個人` で「個人」フォルダ内のメモを検索 |
| 複合検索     | `tag:重要 folder:仕事 会議` のように組合せ可能 |
| 結果表示     | サイドバーに一覧表示。クリックでエディタに開く |

#### 4.1.6 サイドバー

| 機能       | 詳細                                                |
| ---------- | --------------------------------------------------- |
| 表示切替   | ショートカットキーで表示/非表示トグル（`Ctrl+B`等） |
| セクション | 検索 → フォルダツリー → タグ一覧 の縦並び           |

#### 4.1.7 テーマ

| 機能         | 詳細                                       |
| ------------ | ------------------------------------------ |
| ダークモード | デフォルト。目に優しい配色                 |
| ライトモード | 明るい配色                                 |
| 切替         | 設定画面またはショートカットキーで即時切替 |

---

### 4.2 Phase 2（MVP後の追加機能）

#### 4.2.1 リマインダー通知

| 機能             | 詳細                                               |
| ---------------- | -------------------------------------------------- |
| 通知設定         | メモ単位で通知日時を指定                           |
| 繰り返し         | なし / 毎日 / 毎週 / 毎月 から選択                 |
| OS通知           | 設定時刻にOS標準通知で表示                         |
| バックグラウンド | アプリ終了時もバックグラウンドプロセスで通知を監視 |
| 通知クリック     | 通知をクリックするとアプリが開き該当メモに遷移     |

#### 4.2.2 画像・ファイル添付

| 機能     | 詳細                                                       |
| -------- | ---------------------------------------------------------- |
| 画像挿入 | ドラッグ&ドロップまたはペーストで画像をメモに挿入          |
| 画像保存 | SQLite内にBLOBとして保存、またはローカルディレクトリに保存 |
| 表示     | エディタ内でインライン表示                                 |

#### 4.2.3 メモのピン留め

| 機能     | 詳細                                   |
| -------- | -------------------------------------- |
| ピン留め | メモをフォルダ内の最上部に固定表示     |
| 解除     | 右クリックまたはアイコンクリックで解除 |

#### 4.2.4 コードブロック

| 機能                   | 詳細                     |
| ---------------------- | ------------------------ |
| シンタックスハイライト | 言語指定でコードに色付け |

#### 4.2.5 エクスポート / インポート

| 機能             | 詳細                                       |
| ---------------- | ------------------------------------------ |
| エクスポート     | メモ単体を `.md` ファイルとして出力        |
| 一括エクスポート | 全メモをフォルダ構造ごと `.zip` で出力     |
| インポート       | `.md` ファイルを読み込みメモとして取り込み |

---

## 5. データ設計（SQLite）

### 5.1 ER図

```
folders
├── id (PK)
├── name
├── parent_id (FK → folders.id, NULL=ルート)
├── sort_order
├── created_at
└── updated_at

memos
├── id (PK)
├── title
├── content (Markdown原文)
├── folder_id (FK → folders.id)
├── is_pinned (Phase2)
├── created_at
└── updated_at

tags
├── id (PK)
├── name (UNIQUE)
├── color
├── created_at
└── updated_at

memo_tags (多対多)
├── memo_id (FK → memos.id)
└── tag_id (FK → tags.id)

reminders (Phase2)
├── id (PK)
├── memo_id (FK → memos.id)
├── notify_at (DATETIME)
├── repeat_type (none/daily/weekly/monthly)
├── is_active
├── created_at
└── updated_at

memos_fts (FTS5仮想テーブル)
├── title
└── content
```

---

## 6. ショートカットキー一覧（MVP）

| ショートカット        | 動作                         |
| --------------------- | ---------------------------- |
| `Ctrl+N`              | 新規メモ作成                 |
| `Ctrl+W`              | 現在のタブを閉じる           |
| `Ctrl+S`              | 手動保存（自動保存もあり）   |
| `Ctrl+F`              | メモ内検索                   |
| `Ctrl+Shift+F`        | グローバル検索（サイドバー） |
| `Ctrl+B` (エディタ外) | サイドバー表示/非表示        |
| `Ctrl+B` (エディタ内) | 太字                         |
| `Ctrl+I`              | 斜体                         |
| `Ctrl+K`              | リンク挿入                   |
| `Ctrl+Tab`            | 次のタブに切替               |
| `Ctrl+Shift+Tab`      | 前のタブに切替               |
| `Ctrl+,`              | 設定画面を開く               |

---

## 7. 非機能要件

| 項目           | 目標値                              |
| -------------- | ----------------------------------- |
| 起動時間       | **0.5秒以内**（コールドスタート）   |
| メモ切替       | **100ms以内**で表示完了             |
| 検索応答       | 10,000件のメモで**200ms以内**       |
| メモリ使用量   | アイドル時 **50MB以下**             |
| バイナリサイズ | **20MB以下**                        |
| 自動保存       | 最後の入力から **2秒後** に自動保存 |

---

## 8. ロードマップ

```
Phase 0: プロジェクト基盤
├── gpuiプロジェクトセットアップ
├── SQLiteスキーマ作成・マイグレーション
└── 基本ウィンドウ表示

Phase 1: MVP
├── エディタ（Markdownライブレンダリング）
├── フォルダ管理（CRUD・ネスト）
├── タグ管理（CRUD・色・フィルタ）
├── タブ機能
├── 検索（全文・tag:・folder:）
├── サイドバー表示/非表示
├── ダーク/ライトモード
└── 自動保存

Phase 2: 拡張機能
├── リマインダー通知（バックグラウンド常駐）
├── 画像・ファイル添付
├── ピン留め
├── コードブロック シンタックスハイライト
└── エクスポート / インポート
```
